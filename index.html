<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Flappy VIP</title>
<style>
    body {
        margin: 0;
        overflow: hidden;
        background: linear-gradient(to bottom, #70c5ce, #fff);
        font-family: Arial, sans-serif;
    }
    canvas {
        display: block;
        margin: 0 auto;
        background: #70c5ce;
    }
    /* Nút mở menu */
    #menuBtn {
        position: fixed;
        top: 20px;
        left: 20px;
        width: 50px;
        height: 50px;
        border-radius: 50%;
        background-image: url('https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTjltzX_PNVIeWxq_6aQEkw4WVMWpAcg9SthKlM27fKdQ&s');
        background-size: cover;
        background-position: center;
        cursor: pointer;
        border: 2px solid white;
        z-index: 999;
    }
    /* Menu hack */
    #hackMenu {
        position: fixed;
        top: 80px;
        left: 20px;
        background: rgba(0,0,0,0.8);
        color: white;
        padding: 15px;
        border-radius: 10px;
        display: none;
        animation: rainbow-border 3s linear infinite;
        border: 3px solid;
    }
    @keyframes rainbow-border {
        0% { border-color: red; }
        16% { border-color: orange; }
        33% { border-color: yellow; }
        50% { border-color: green; }
        66% { border-color: blue; }
        83% { border-color: indigo; }
        100% { border-color: violet; }
    }
    .btn {
        background: #444;
        color: white;
        border: none;
        padding: 5px 10px;
        margin: 5px 0;
        cursor: pointer;
        border-radius: 5px;
        width: 100%;
    }
    .loading-bar {
        height: 8px;
        background: linear-gradient(90deg, red, orange, yellow, green, blue, indigo, violet);
        background-size: 200% 100%;
        animation: loadingMove 1.8s linear forwards;
        border-radius: 4px;
        margin-top: 5px;
    }
    @keyframes loadingMove {
        from { width: 0%; background-position: 0 0; }
        to { width: 100%; background-position: 200% 0; }
    }
</style>
</head>
<body>

<canvas id="gameCanvas" width="320" height="480"></canvas>

<div id="menuBtn"></div>
<div id="hackMenu">
    <div>
        <label>Tốc độ:</label>
        <select id="speedSelect" class="btn">
            <option value="1">1 (Bình thường)</option>
            <option value="2">2</option>
            <option value="3">3</option>
        </select>
    </div>
    <button id="antibanBtn" class="btn">Antiban</button>
    <div id="loadingContainer"></div>
</div>

<script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let frames = 0;
    const DEGREE = Math.PI/180;
    let gameSpeed = 1;

    const bird = {
        x: 50,
        y: 150,
        w: 34,
        h: 26,
        gravity: 0.25,
        jump: 4.6,
        speed: 0,
        draw(){
            ctx.fillStyle = "yellow";
            ctx.fillRect(this.x, this.y, this.w, this.h);
        },
        flap(){
            this.speed = -this.jump;
        },
        update(){
            this.speed += this.gravity;
            this.y += this.speed;
            if (this.y + this.h >= canvas.height) {
                this.y = canvas.height - this.h;
                gameOver();
            }
        }
    };

    function gameOver(){
        cancelAnimationFrame(loop);
        ctx.fillStyle = "red";
        ctx.font = "30px Arial";
        ctx.fillText("GAME OVER", 70, 240);
    }

    function draw(){
        ctx.fillStyle = "#70c5ce";
        ctx.fillRect(0,0,canvas.width,canvas.height);
        bird.draw();
    }

    function update(){
        bird.update();
    }

    function loopGame(){
        update();
        draw();
        frames++;
        loop = requestAnimationFrame(loopGame);
    }

    let loop = requestAnimationFrame(loopGame);

    document.addEventListener("keydown", e => {
        if (e.code === "Space") bird.flap();
    });
    canvas.addEventListener("click", () => bird.flap());

    // Menu
    const menuBtn = document.getElementById("menuBtn");
    const hackMenu = document.getElementById("hackMenu");
    menuBtn.onclick = () => {
        hackMenu.style.display = hackMenu.style.display === "block" ? "none" : "block";
    };

    // Speed select
    document.getElementById("speedSelect").onchange = function(){
        gameSpeed = Number(this.value);
        bird.gravity = 0.25 * gameSpeed;
        bird.jump = 4.6 * gameSpeed;
    };

    // Antiban button
    document.getElementById("antibanBtn").onclick = () => {
        const loading = document.createElement("div");
        loading.className = "loading-bar";
        const container = document.getElementById("loadingContainer");
        container.innerHTML = "";
        container.appendChild(loading);
        setTimeout(() => {
            container.innerHTML = "<span style='color:lightgreen'>Antiban hoàn tất!</span>";
        }, 1800);
    };
</script>

</body>
</html>
